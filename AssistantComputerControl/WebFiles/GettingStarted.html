<!doctype html>
<html lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=11">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="assets/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link rel="stylesheet" href="assets/sweetalert2.min.css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous" />

    <title>ACC Setup Guide</title>

    <!-- Thanks to dcs9988 from Bootsnipp for the step-wizard(https://bootsnipp.com/snippets/e3MBM) -->
    <style>
        .cloud_service_card {
            cursor: pointer;
        }

        .ribbon {
            width: 150px;
            height: 150px;
            overflow: hidden;
            position: absolute;
        }

            .ribbon::before,
            .ribbon::after {
                position: absolute;
                z-index: -1;
                content: '';
                display: block;
                border: 5px solid dodgerblue;
            }

            .ribbon span {
                position: absolute;
                display: block;
                width: 225px;
                padding: 15px 0;
                background-color: dodgerblue;
                box-shadow: 0 5px 10px rgba(0,0,0,.1);
                color: #fff;
                font: 700 18px/1 'Lato', sans-serif;
                text-shadow: 0 1px 1px rgba(0,0,0,.2);
                text-transform: uppercase;
                text-align: center;
            }

        /* bottom right*/
        .ribbon-bottom-right {
            bottom: -10px;
            right: -10px;
        }

            .ribbon-bottom-right::before,
            .ribbon-bottom-right::after {
                border-bottom-color: transparent;
                border-right-color: transparent;
            }

            .ribbon-bottom-right::before {
                bottom: 0;
                left: 0;
            }

            .ribbon-bottom-right::after {
                top: 0;
                right: 0;
            }

            .ribbon-bottom-right span {
                left: -25px;
                bottom: 30px;
                font-size: 16px;
                /*transform: rotate(-225deg);*/
                transform: rotate(-45deg);
            }

        #nextButton {
            position: fixed;
            right: 20px;
            height: 70%;
            top: 70px;
            background-color: transparent;
            border-color: transparent;
            color: #212121;
            transition: 0.1s;
            border-radius: 0px;
            z-index: 9999;
        }

        #previousButton {
            position: fixed;
            left: 20px;
            height: 70%;
            top: 70px;
            background-color: transparent;
            border-color: transparent;
            color: #212121;
            transition: 0.1s;
            border-radius: 0px;
            z-index: 9999;
        }

            #nextButton:hover, #previousButton:hover {
                color: #fff !important;
                background-color: #428bca;
                border-color: #357ebd;
            }

        body {
            margin-top: 10px;
            font-size: 15px;
            overflow: hidden;
        }

        .stepwizard-step p {
            margin-top: 10px;
        }

        .stepwizard-row {
            display: table-row;
        }

        .stepwizard {
            display: table;
            width: 100%;
            position: relative;
        }

        .stepwizard-step button[disabled] {
            opacity: 1 !important;
            filter: alpha(opacity=100) !important;
        }

        .stepwizard-row:before {
            top: 14px;
            bottom: 0;
            position: absolute;
            content: " ";
            width: 100%;
            height: 1px;
            background-color: #ccc;
            z-order: 0;
        }

        .stepwizard-step {
            display: table-cell;
            text-align: center;
            position: relative;
        }

        .btn-circle {
            width: 30px;
            height: 30px;
            text-align: center;
            padding: 6px 0;
            font-size: 12px;
            line-height: 1.428571429;
            border-radius: 15px;
            -webkit-appearance: button-bevel !important;
        }

        /* Loading */
        #dropboxImage {
            transition: 1s;
            opacity: 0.6;
        }

        .loading_container {
            justify-content: center;
            align-items: center;
        }

        #loading_elements1 {
            text-align: center;
            opacity: 0.8;
            display: flex;
            flex-direction: row;
            margin-top: -100px;
            margin-right: -100px;
            text-align: right;
            float: right;
        }

        .loading_elements2 {
            text-align: center;
            opacity: 0.8;
            display: flex;
            flex-direction: row;
            /*margin-top: -100px;
            margin-right: 260px;*/
            position: fixed;
            left: 43%;
        }

        .elements .el {
            width: 10px;
            height: 40px;
            background: #212121;
            margin: 5px;
            animation-name: hover;
            animation-duration: 0.5s;
            animation-iteration-count: infinite;
            animation-fill-mode: forwards;
            animation-direction: alternate;
            animation-timing-function: ease-out;
            transform: translate3d(0, 20%, 0);
        }

            .elements .el:nth-of-type(2) {
                animation-delay: 0.2s;
            }

            .elements .el:nth-of-type(3) {
                animation-delay: 0.4s;
            }

            .elements .el:nth-of-type(4) {
                animation-delay: 0.6s;
            }

        @keyframes hover {
            0% {
                transform: translate3d(0, 20%, 0);
                opacity: 0.5;
            }

            100% {
                transform: translate3d(0, -20%, 0);
                opacity: 0.9;
            }
        }

        .blink_me {
            transition: 0.1s;
            animation: blinker 1s linear infinite;
        }

        @keyframes blinker {
            0% {
                color: black;
            }

            50% {
                color: green;
            }
        }

        .btn.disabled {
            pointer-events: auto;
        }

        ol {
            margin: 0 0 1.5em;
            padding: 0;
            counter-reset: item;
        }

        ol > li {
            margin: 0;
            padding: 0 0 0 2em;
            text-indent: -2em;
            list-style-type: none;
            counter-increment: item;
        }

        ol > li:before {
            display: inline-block;
            width: 1em;
            padding-right: 0.5em;
            font-weight: bold;
            text-align: right;
            content: counter(item) ".";
        }

        .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left] {
            left: -1.5em;
            -webkit-transform: rotate(45deg);
            transform: rotate(45deg);
        }

        .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right] {
            right: -1.5em;
            -webkit-transform: rotate(-45deg);
            transform: rotate(-45deg);
        }

        .container {
            padding-right: 60px;
            padding-left: 60px;
        }
    </style>
    <style>
        /*.btn-default {
            color: white;
            background-color: rgba(0, 0, 0, 0.2);
        }*/

        ol li {
            margin-bottom: 10px;
        }

        .scroller {
            height: 200px;
            overflow-y: auto;
        }

        .cloud_service_card .card-body img {
            /*width:100%;*/
            max-width: 100%;
            max-height: 100px;
        }

        .cloud_service_card .card-body {
            height: 250px;
        }

        .noselect {
            -webkit-touch-callout: none; /* iOS Safari */
            -webkit-user-select: none; /* Safari */
            -khtml-user-select: none; /* Konqueror HTML */
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none;
            /* Non-prefixed version, currently
                                                     supported by Chrome and Opera */
        }

        .card-selected {
            border: 2px solid blue;
        }
    </style>
</head>

<body class="container-fluid noselect" style="margin-bottom:10px;">
    <div id="choose_cloud_service" class="row text-center">
        <div class="col-md-12">
            <h2 data-translation-key="welcome_title">Welcome to AssistantComputerControl!</h2>

            <p data-translation-key="welcome_description">
                This software needs a cloud service to function. We natively support Dropbox, Google Drive and OneDrive.
            </p>
        </div>

        <div class="col-md-12">
            <div class="row">
                <div class="col-md-3">
                    <div class="card cloud_service_card" data-name="Dropbox" data-num="1" data-image="assets/cloud_services/dropbox.png">
                        <div class="card-body">
                            <div class="ribbon ribbon-bottom-right"><span data-translation-key="recommended">RECOMMENDED</span></div>

                            <h5 class="card-title">Dropbox</h5>
                            <h6 data-translation-key="click_me" class="card-subtitle mb-2 text-muted">Click me!</h6>
                            <img alt="Dropbox logo" draggable="false" src="assets/cloud_services/dropbox.png">
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card cloud_service_card" data-name="OneDrive" data-num="2" data-image="assets/cloud_services/onedrive.png">
                        <div class="card-body">
                            <h5 class="card-title">OneDrive</h5>
                            <h6 data-translation-key="click_me" class="card-subtitle mb-2 text-muted">Click me!</h6>
                            <img alt="OneDrive logo" draggable="false" src="assets/cloud_services/onedrive.png">
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card cloud_service_card" data-name="Google Drive" data-num="3"
                         data-image="assets/cloud_services/googledrive.png">
                        <div class="card-body">
                            <h5 class="card-title">Google Drive</h5>
                            <h6 data-translation-key="click_me" class="card-subtitle mb-2 text-muted">Click me!</h6>
                            <img alt="Google Drive logo" draggable="false" src="assets/cloud_services/googledrive.png">
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card cloud_service_card" data-name="the expert setup" data-num="4">
                        <div class="card-body">
                            <h5 class="card-title">Expert setup</h5>
                            <h6 class="card-subtitle mb-2 text-muted">
                                <small data-translation-key="expert_setup_short_desc">Choose me if you want more freedom (custom setup, no help)</small>
                            </h6>
                            <img alt="Expert solution icon" draggable="false" src="assets/cloud_services/expert.png">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-12" style="margin-top:20px;">
            <button id="pick_btn" class="btn btn-primary btn-block btn-lg" disabled>Pick a cloud service</button>
        </div>

        <div class="col-md-12">
            <a id="skip_guide_text" data-translation-key="skip_guide_text" href="#">Click here to skip the setup guide <i>(not recommended)</i></a>
        </div>
    </div>

    <!-- -- -->
    <div id="cloud_setup" class="container" style="display:none;max-width:100%;">
        <div class="stepwizard">
            <div class="stepwizard-row setup-panel">
                <div class="stepwizard-step">
                    <a id="step-1-btn" data-step-num="1" href="#step-1" type="button"
                       class="btn btn-primary btn-circle">1</a>
                    <p data-translation-key="step_1_title">Install <span id="install_step_name"></span></p>
                </div>
                <div class="stepwizard-step">
                    <a id="step-2-btn" data-step-num="2" href="#step-2" type="button" class="btn btn-default btn-circle"
                       disabled="disabled">2</a>
                    <p data-translation-key="step_2_title">Set up IFTTT</p>
                </div>
                <div class="stepwizard-step">
                    <a id="step-3-btn" data-step-num="3" href="#step-3" type="button" class="btn btn-default btn-circle"
                       disabled="disabled">3</a>
                    <p data-translation-key="step_3_title">Done! Test actions</p>
                </div>
            </div>
        </div>

        <form role="form" action="" method="post" style="text-align:center;">
            <div class="row setup-content" id="step-1">
                <div class="col-md-12">
                    <h3>
                        <span id="step-1-title" data-translation-key="install_text">Install <span class="service-name"></span></span>
                        <small id="looking_text" data-translation-key="looking_for_service">looking...</small>
                        <span id="service_found" style="display:none;"> - <b>installed!</b></span>
                    </h3>
                    <p id="couldNotFindService">
                        We could not locate <span class="service-name"></span> on your computer.
                    </p>

                    <div id="multipleOneDrive" style="display:none;">
                        <p>We can see you have a personal and work OneDrive - which one do you want to use?</p>

                        <button data-translation-key="personal_onedrive" data-onedrive-type="OneDriveConsumer" class="onedrive_type chosen_onedrive_type btn btn-primary btn-sm" style="margin-right:10px;">Personal OneDrive</button>
                        <button data-translation-key="work_onedrive" data-onedrive-type="OneDriveCommercial" class="onedrive_type btn btn-default btn-sm">Work OneDrive</button>
                    </div>

                    <small><i>(<span data-translation-key="not_working_modal_opener">click <a data-toggle="modal" data-target="#doesntWorkModal" href="#">here</a> if <span class="service-name"></span> <u>is</u> installed, and you <u>have</u> followed the instructions step-by-step, but ACC won't let you proceed</span></i>)</small>.<br>

                    <img draggable="false" id="chosenCloudServiceImage" alt="Cloud service logo" style="max-width:150px;" src="">
                    <div id="loading_container1" class="loading_container row">
                        <div id="loading_elements1" class="elements">
                            <div class="el"></div>
                            <div class="el"></div>
                            <div class="el"></div>
                            <div class="el"></div>
                        </div>
                    </div>

                    <!-- Dropbox -->
                    <div id="dropbox-install-guide" style="display:none;">
                        <ol>
                            <li class="strike-out-if-installed">
                                <a data-translation-key="dropbox_sign_up" href="https://www.dropbox.com/register">Sign up for Dropbox</a>
                                <small data-translation-key="if_you_havent_already">(if you haven't already)</small>
                            </li>
                            <li class="strike-out-if-installed"><a data-translation-key="download_dropbox" href="https://www.dropbox.com/downloading">Download the Dropbox installer</a></li>
                            <li class="strike-out-if-installed" data-translation-key="open_installer_dropbox">Open the installer, and install Dropbox on your computer</li>
                        </ol>
                    </div>
                    <!-- OneDrive -->
                    <div id="onedrive-install-guide" style="display:none;">
                        <ol>
                            <li class="strike-out-if-installed">
                                <a data-translation-key="onedrive_sign_up" href="https://onedrive.live.com/">Sign up for OneDrive (the same as an Microsoft account)</a>
                                <small data-translation-key="if_you_havent_already">(if you haven't already)</small>
                            </li>
                            <li class="strike-out-if-installed" data-translation-key="download_onedrive">If you're using Windows 8 or up, you will most likely have OneDrive<br>on your computer already. If not, <a href="https://onedrive.live.com/about/en-sg/download/">download and run the OneDrive installer</a></li>
                            <li class="strike-out-if-installed" data-translation-key="onedrive_go_to_folder">Go to the OneDrive folder in the file explorer</li>
                            <li class="strike-out-if-installed-partial" data-translation-key="onedrive_create_folder">Create a folder called "AssistantComputerControl"</li>
                            <li data-translation-key="onedrive_always_keep">Right-click the created folder and press "Always keep on this device" <b><i>(quite important)</i></b></li>
                        </ol>
                        <img draggable="false" style="max-width:100%;max-height:300px;" type="gif" alt="" src="assets/gifs/onedrive_howto.gif">
                    </div>
                    <!-- Google Drive -->
                    <div id="google-drive-install-guide" style="display:none;">
                        <ol>
                            <li class="strike-out-if-installed" data-translation-key="make_google_account">You most likely already have a Google account - if not, <a href="https://accounts.google.com/signup/v2">make one</a></li>
                            <li class="strike-out-if-installed" data-translation-key="google_drive_download">Download Google Drive for your computer <a href="https://www.google.com/drive/download/">choose "Private; Backup and Sync"</a> <small>(if you haven't already)</small></li>
                            <li class="strike-out-if-installed" data-translation-key="google_drive_install">Run the installer and finish the install</li>
                            <li class="strike-out-if-installed-partial" data-translation-key="google_drive_click_logo">Click on the "Backup and sync" logo in your taskbar</li>
                            <li class="strike-out-if-installed-partial" data-translation-key="google_drive_preferences">Press the three dots in the right corner, and go to <b>"Preferences"</b></li>
                            <li class="strike-out-if-installed-partial" data-translation-key="google_drive_sync">Go to the <b>"Google Drive"</b> tab and make sure <b>"Sync My Drive to this computer"</b> is ticked</li>
                        </ol>
                        <hr>
                        <div class="row">
                            <div class="col-md-6">
                                <h5 data-translation-key="google_drive_sync_all">Want all your Google Drive files on your computer?</h5>
                                <ol>
                                    <li data-translation-key="google_drive_sync_all_desc">Choose "Sync everything in My Drive (x GB)"</li>
                                </ol>
                                <img draggable="false" style="width:100%;" type="gif" alt="" src="assets/gifs/sync_all_folders.gif">
                            </div>
                            <div class="col-md-6">
                                <h5 data-translation-key="google_drive_acc_only_sync">... or <i>just</i> for the sake of AssistantComputerControl?</h5>
                                <ol>
                                    <li><a href="https://drive.google.com/drive/" data-translation-key="google_drive_website_goto">Go to your Google Drive (in your browser)</a></li>
                                    <li data-translation-key="google_drive_create_folder">In the "My drive" tab, right-click the section files-section or press the "My drive" dropdown, and choose <b>"New folder"</b></li>
                                    <li data-translation-key="google_drive_name_folder">Name the folder "AssistantComputerControl" <i>(it's important that there are no typos here)</i></li>
                                    <li data-translation-key="google_drive_sync_specific_folders">Choose "Sync these folders only...", and un-tick everything but the folder called "AssistantComputerControl"</li>
                                </ol>
                                <img style="width:100%;" type="gif" alt="" src="assets/gifs/sync_specific_folder.gif">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- IFTTT part -->
            <div class="row setup-content" id="step-2" style="display:none;">
                <div class="col-md-12">
                    <div style="text-align:center;">
                        <img draggable="false" src="assets/images/ifttt_logo.png" style="width:200px;" />
                    </div>
                    <h3 style="margin-top:8px;">
                        <span data-translation-key="set_up_ifttt_acc">Set up your IFTTT account</span>
                        <br>
                        <small><i><span data-translation-key="set_up_ifttt_extra">With the AssistantComputerControl applets</span></i></small>
                    </h3>

                    <ol style="text-align:left;margin-left:20px;margin-right:20px;">
                        <li>
                            <a data-translation-key="ifttt_join" href="https://ifttt.com/join">Sign up for IFTTT</a>
                            <i>
                                <small data-translation-key="ifttt_join_extra">(it's smart to sign up with your Google account if you're using Google Assistant)</small>
                            </i>
                        </li>
                        <li>
                            <span data-translation-key="ifttt_enable_shutdown_applet">
                                Enable the applets you want. Let's start with the <code>shutdown</code> action <small>(shuts down your computer)</small>.
                            </span>
                            <!-- Links are set automatically depending on the chosen cloud service -->
                            <a data-translation-key="ifttt_shutdown_link_gh" class="shutdown_test_link_gh" href="#">Click here if you're using Google Assistant</a>, <a data-translation-key="ifttt_shutdown_link_alexa" class="shutdown_test_link_alexa" href="#">or here if you use Amazon Alexa</a>
                        </li>
                        <li data-translation-key="ifttt_connect_applet">Click "Connect" on the IFTTT applet</li>
                        <li data-translation-key="ifttt_link_info">
                            If you haven't linked your <span class="service-name"></span> or Google/Amazon account yet, you will be asked to link your accounts
                        </li>
                    </ol>
                </div>
            </div>
            <!-- "Done" - test actions -->
            <div class="row setup-content" id="step-3" style="display:none;">
                <div class="col-md-12">
                    <div id="timeToTryText">
                        <h3 data-translation-key="time_to_try_heading">Time to try!</h3>
                        <p>
                            <!--<span data-translation-key="done_description"></span><br>-->
                            <!--<i>
                            <small><span data-translation-key="applet_enable_reminder"></span> (<a class="shutdown_test_link_gh" href="#">[Google Assistant]</a>, <a class="shutdown_test_link_alexa" href="#">[Amazon Alexa]</a>)</small>
                        </i><br />-->


                            <small><i><span data-translation-key="custom_trigger_reminder"></span></i></small>
                            <div style="text-align:left;margin-top:2px;">
                                <div style="display:inline-block;margin-right:15px;">
                                    <div>
                                        <img draggable="false" src="assets/images/voice-icon.png" style="width:50px;" />
                                    </div>
                                </div>
                                <div style="display:inline-block;">
                                    <span data-translation-key="google_assistant_trigger_example">The <b>Google Assistant</b> trigger would be;</span> <i>"Hey Google, turn off my computer"</i><br>
                                    <span data-translation-key="alexa_trigger_example">For <b>Alexa</b>, you'd need to say</span> <i>"Alexa, trigger turn off my computer"</i>
                                </div>
                            </div>

                            <br>
                            <b>
                                <span data-translation-key="wont_execute_reminder"></span>
                            </b>
                        </p>

                        <div style="text-align:center;">
                            <p style="z-index:9999;color:gray;"><b><i>Listening for actions...</i></b></p>
                            <div style="margin-top:-10px;">
                                <div class="loading_container row">
                                    <div class="elements loading_elements2">
                                        <div class="el"></div>
                                        <div class="el"></div>
                                        <div class="el"></div>
                                        <div class="el"></div>
                                    </div>
                                </div>
                            </div>

                            <div style="text-align:left;margin-top:60px;">
                                <button data-toggle="modal" data-target="#finalDoesntWorkModal" class="btn btn-sm btn-danger">Is it not working?</button>
                            </div>
                        </div>
                    </div>

                    <!-- Success & error icon -->
                    <div id="success_icon" class="swal2-icon swal2-success swal2-animate-success-icon"
                         style="display: none;">
                        <div class="swal2-success-circular-line-left" style="background-color: rgb(255, 255, 255);"></div>
                        <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
                        <div class="swal2-success-ring"></div>
                        <div class="swal2-success-fix" style="background-color: rgb(255, 255, 255);"></div>
                        <div class="swal2-success-circular-line-right" style="background-color: rgb(255, 255, 255);"></div>
                    </div>
                    <div id="error_icon" class="swal2-icon swal2-error swal2-animate-error-icon" style="display:none;">
                        <span class="swal2-x-mark">
                            <span class="swal2-x-mark-line-left"></span><span class="swal2-x-mark-line-right"></span>
                        </span>
                    </div>

                    <h3 id="success_setup_action_went_through" style="display:none;">Software all set up! Received "<code><span></span></code>" action</h3>
                    <h3 style="display:none;" id="status_message"></h3>
                    <h4 id="fast_message" style="display:none;">You're a fast learner!</h4>
                    <h4 id="too_fast_message" style="display:none;">You were fast, but, were you <i>too</i> fast...?</h4>

                    <button id="continue_button" style="border-radius:0;display:none;" class="btn btn-primary btn-block btn-lg">Continue & explore the software!</button>
                </div>
            </div>
        </form>

        <button id="previousButton" class="btn btn-primary btn-lg leftRightBtn" type="button">
            <i class="fas fa-2x fa-chevron-left"></i>
        </button>
        <div id="nextButtonWrapper">
            <button id="nextButton" disabled class="btn btn-primary nextBtn btn-lg leftRightBtn" type="button"
                    data-toggle="popover" title="<b>Ahem...</b>" data-html="true" data-placement="left"
                    data-content="We <i>have</i> found the cloud service, you may proceed!">
                <i class="fas fa-2x fa-chevron-right"></i>
            </button>
        </div>

        <!-- "Change language anytime" button in bottom right corner -->
        <div style="position:fixed;bottom:0;right:0;margin:20px;" data-toggle="tooltip" data-placement="top" title="Change language">
            <button data-target="#languageModal" data-toggle="modal" class="btn btn-sm btn-default"><img draggable="false" src="assets/images/language-icon.png" style="width:40px;" /></button>
        </div>
    </div>

    <!-- "Doesn't work" modal -->
    <div class="modal fade" id="doesntWorkModal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Manual setup</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="fixModalContent" style="display:none;">
                        <form>
                            <p>
                                If you're positive that this service <i>is indeed</i> installed and you have followed all the steps, but ACC won't let you go to the next one;
                                fill out the field below.<br>If you have chosen a custom path during the installation, ACC might not be able to detect it.
                            </p>

                            <div class="form-group">
                                <label>Action folder path</label>
                                <p class="text-muted">
                                    Full path to your <span class="service-name"></span> folder. This will most likely be something like
                                    <code>C:/Users/your_user/<span class="service-name"></span></code>
                                </p>
                                <input id="manualCheckPath" class="form-control" placeholder="C:/Users/myuser/service/AssistantComputerControl">
                            </div>
                            <br>
                            <button type="submit" id="custom_path_submit" class="btn btn-primary btn-block">Submit and check</button>
                        </form>
                    </div>
                    <div id="loadingModalContent" class="text-center" style="display:none;">
                        <h4>Checking path...</h4>
                        <h2><i class="fas fa-spinner fa-spin"></i></h2>
                    </div>
                    <div id="pathSuccess" class="text-center" style="display:none;">
                        <h4>Success! Path manually entered. You may now proceed.</h4>
                        <h1><i style="color:green;" class="fas fa-check"></i></h1>
                        <button data-dismiss="modal" class="btn btn-secondary">Close this window</button>
                    </div>
                    <div id="pathError" class="text-center" style="display:none;">
                        <h4>Error. Path is not valid - please check it again.</h4>
                        <h1><i style="color:red;" class="fas fa-times"></i></h1>
                        <p class="help-text">This message will disappear in 8 seconds</p>
                        <button onclick="$('#pathError').hide();$('#fixModalContent').show();if(activeTimeout !== null) clearTimeout(activeTimeout);" class="btn-sm btn btn-secondary"><i>Try again</i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Troubleshooting modal if the user doesn't think it's working in the last step -->
    <div class="modal fade" id="finalDoesntWorkModal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 data-translation-key="not_working_modal_title" class="modal-title">The software is not working</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="text-center">
                        <h6><b data-translation-key="not_working_title">Fear not. Most issues are easily fixed!</b></h6>
                        <p data-translation-key="not_working_description">Let's go through some of the most common issues, and get the software up and running in a matter of minutes!</p>
                    </div>

                    <p data-translation-key="repeat_step_two_suggestion" style="font-weight:bold;">
                       First, it's recommended that you try and go through <a href="#" style="cursor:pointer;" data-dismiss="modal" onclick="setStep(2);">step 2</a> again. If you're certain it's set up correctly, proceed to the solutions below.
                    </p>

                    <hr />

                    <h5 data-translation-key="problem_introduction_title">What's problem are you experiencing?</h5>
                    <p data-translation-key="problem_introduction_description" class="text-muted">Click the panel that best describes your problem</p>
                    <!-- Simple static troubleshooting -->
                    <div id="accordion">
                        <div class="card">
                            <div class="card-header">
                                <a class="card-link" data-toggle="collapse" href="#assistantResponseIssues">
                                    <span data-translation-key="assistant_response_issues_title">My assistant doesn't understand the trigger</span>
                                </a>
                            </div>
                            <div id="assistantResponseIssues" class="collapse" data-parent="#accordion">
                                <div class="card-body">
                                    <p class="text-muted" data-translation-key="assistant_response_issues_desc"><b>Problem:</b> <i>(example)</i> My Google Assistant/Alexa doesn't understand any of the triggers (what I am saying). <i>(No matter if the ACC software works or not, IFTTT should still respond)</i></p>
                                    <ol>
                                        <li data-translation-key="tbs_assistant_solution_one">
                                            Make sure that the assistant <i>(Google Assitant or Alexa)</i> account that you linked to your IFTTT account is the same one as the assistant you're talking to is linked to.
                                        </li>
                                        <li data-translation-key="tbs_assistant_solution_two">
                                            Make sure that you have <a href="https://assistantcomputercontrol.com/#what-can-it-do" target="_blank">applets enabled</a> on the account that is linked to your assistant. ACC doesn't actually have anything to do with your assistant, so this issue is on IFTTT or your assistant service
                                        </li>
                                        <li data-translation-key="tbs_assistant_solution_three">
                                            <b>If you're using Alexa;</b> IFTTT requires you to say <i>Alexa, <b>trigger</b> x</i> before the actual trigger, and would always respond <i>"OK. Sending that to IFTTT.</i>
                                        </li>
                                        <li data-translation-key="tbs_assistant_solution_four">
                                            <b>If you're using Google Assistant;</b>
                                            if your Google Assistant device <i>(whether it's your phone or a physical product)</i> might be set to a different language than the one your IFTTT applet is set to. If your applet language is set to "English" but the only language you have enabled on your Google Assistant account is "Italian", your Google Assistant wouldn't understand the english phrase. You can tell that this is the problem if the command you say is in a different language than the response you get <i>(fx. if I say an English phrase to my assistant, and it responds that it doesn't understand, but in Italian)</i>
                                        </li>
                                        <li data-translation-key="tbs_assistant_solution_five">
                                            Check the <a target="_blank" href="https://status.ifttt.com/#about-this-site">status of IFTTT</a> - if they're currently experiencing issues, try and wait
                                        </li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <a class="collapsed card-link" data-toggle="collapse" href="#pcIssuesProblem">
                                    <span data-translation-key="pc_issues_title">Assistant responds, but nothing happens on the computer</span>
                                </a>
                            </div>
                            <div id="pcIssuesProblem" class="collapse" data-parent="#accordion">
                                <div class="card-body">
                                    <p class="text-muted" data-translation-key="pc_issues_desc"><b>Problem:</b> The assistant responds, but nothing happens on my computer.</p>
                                    <ol>
                                        <li data-translation-key="tbs_pc_solution_one">Your cloud service <i>(Dropbox, OneDrive, Google Drive)</i> has to be installed and running on your PC at all times - if it's closed, make sure to open it.</li>
                                        <li data-translation-key="tbs_pc_solution_two">Cloud service should be <b>fully synced!</b> If (for example) Dropbox is syncing x-hundred amounts of files, give your cloud service some time to fully sync all the files to your computer</li>
                                        <li data-translation-key="tbs_pc_solution_three">Check your <a href="https://ifttt.com/activity" target="_blank">IFTTT activity page</a>. If it says "Applet failed", something is wrong on IFTTT's end. This can sometimes be resolved by disconnecting your assistant and cloud service account, and reconnecting it. Check the <a href="https://acc.readme.io/docs/fixing-ifttt-errors" target="_blank">"Fixing IFTTT errors"</a> guide</li>
                                        <li data-translation-key="tbs_pc_solution_four">Try and clear your <b>action folder</b> (which is located at <code>Cloudservice/AssistantComputerControl</code>, fx. <code>C:/Dropbox/AssistantComputerControl</code>). The folder should be completely empty.</li>
                                        <li data-translation-key="tbs_pc_solution_five">Make sure the account your cloud service is logged into on your PC is the same account as the one linked to your IFTTT account <i>(refer to the "<a href="https://acc.readme.io/docs/fixing-ifttt-errors#section-check-cloud-service-connection" target="_blank">Check cloud service connection</a>" section of the "Fixing IFTTT errors" guide)</i></li>
                                        <li data-translation-key="tbs_pc_solution_six">Make sure the IFTTT applet you're using is an applet for the cloud service you have chosen during the ACC installation on your computer</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                        <br />
                        <div class="card">
                            <div class="card-header">
                                <a class="collapsed card-link" data-toggle="collapse" href="#otherIssues">
                                    <i><span data-translation-key="tbs_still_not_resolved_title">Still not resolved (more advanced fixes)</span></i>
                                </a>
                            </div>
                            <div id="otherIssues" class="collapse" data-parent="#accordion">
                                <div class="card-body">
                                    <p data-translation-key="tbs_still_not_resolved_desc">If all solutions above have failed, please refer to the <a target="_blank" href="https://acc.readme.io/docs/troubleshooting#section-still-not-solved-">troubleshooting guide</a> <i>(specifically the "Still not solved?" section)</i></p>
                                    <hr />
                                    <p data-translation-key="tbs_still_not_resolved_community_help">
                                        If it's <b>still</b> not working, come join our <a href="https://discord.gg/B9YGPNF" target="_blank"><i>Discord server</i></a>. With over 550 members, you're sure to get help quickly <i>(and the developer often answers within a few hours)</i>
                                        <br />
                                        In case you believe you have found a bug, you can open an <a target="_blank" href="https://github.com/AlbertMN/AssistantComputerControl/issues">issue on GitHub</a> and describe the issue.
                                    </p>
                                </div>
                            </div>
                        </div>


                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Error on finish -->
    <div class="modal fade" id="finishError" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Error</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body text-center">
                    <h4>Something went wrong - the desired path could not be found</h4>
                    <p class="text-muted"></p>
                    <h1><i style="color:red;" class="fas fa-times"></i></h1>
                    <p class="help-text">This message will disappear in 10 seconds</p>
                    <button data-dismiss="modal" class="btn-sm btn btn-secondary"><i>Try again</i></button>
                </div>
            </div>
        </div>
    </div>

    <!-- Choose language modal -->
    <div class="modal" data-backdrop="static" id="languageModal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div style="text-align:center;margin-bottom:10px;">
                        <img draggable="false" src="assets/images/language-icon.png" style="width:120px;" />
                    </div>
                    <h4 data-translation-key="test"><b>Choose your language</b></h4>
                    <small>You can help us translate the software! <a href="#LINK TODO">Click here for more info</a></small>
                    <div style="margin-top:10px;" class="form-group">
                        <select id="chosen_language" class="form-control"></select>
                    </div>
                    <div>
                        <button id="continueLangBtn" class="btn btn-primary btn-block btn-lg btn-btn">Continue with "English"</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="assets/jquery.js"></script>
    <script src="assets/sweetalert2.min.js"></script>
    <script src="assets/popper.min.js"></script>
    <script src="assets/bootstrap.min.js"></script>

    <script>
        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });

        /* TRANSLATION STUFF */
        var chosenLanguageSelect = $("#chosen_language"), langBtn = $("#continueLangBtn"), languageModal = $("#languageModal"), theTranslation, theFallbackTranslation;

        function SetLanguages(augment) {
            var data = JSON.parse(augment);

            chosenLanguageSelect.empty();
            $.each(data, function (i, thing) {
                chosenLanguageSelect.append("<option name='" + thing + "'>" + thing + "</option>");
            });
            chosenLanguageSelect.find("option:contains('English')").prop("selected", true);
        }

        chosenLanguageSelect.on("change", function () {
            langBtn.text("Continue with \"" + $(this).val() + "\"");
        });

        langBtn.on("click", function () {
            window.external.SetLanguage($(chosenLanguageSelect).val());
            languageModal.modal("hide");
        });

        //languageModal.modal("show");

        function SetTranslation(translation_json, fallback_json) {
            if (typeof translation_json !== 'undefined') {
                theTranslation = JSON.parse(translation_json);
            }
            if (typeof translation_json !== 'undefined') {
                theFallbackTranslation = fallback_translation = (fallback_json == null ? null : JSON.parse(fallback_json));
            }

            Object.keys(theTranslation).forEach(function (key) {
                var theText = theTranslation[key];
                theText = theText.replace("{cloud_service}", "<span class='service-name'></span>");

                if (key == "not_working_modal_opener") {
                    theText = theText.replace("{link_start}", "<a data-toggle=\"modal\" data-target=\"#doesntWorkModal\" href=\"#\">");
                } else if (key == "repeat_step_two_suggestion") {
                    theText = theText.replace("{link_start}", "<a href=\"#\" style=\"cursor: pointer;\" data-dismiss=\"modal\" onclick=\"setStep(2);\">");
                }

                theText = theText.replace("{link_end}", "</a>");

                $("[data-translation-key='" + key + "']").html(theText);
                //alert('Key : ' + key + ', Value : ' + translation[key]);
            })
        }


        /* END TRANSLATIONS */


        var activeStep = 1
            , cloudServiceInstalled = false
            , canProceed = false
            , showProceedTip = false
            , tipTimeout = null
            , nextButton = $("#nextButton")
            , previousButton = $("#previousButton")
            , tipShown = false

            , hasBeenAtStep3 = false
            , actionErrorTimer = null
            , canPopover = false

            , chosenCloudService = ""
            , chosenCloudServiceNum = 0
            , chosenCloudServiceImage

            , stepDivs = [$("#dropbox-install-guide"), $("#onedrive-install-guide"), $("#google-drive-install-guide")]
            , activeTimeout = null
            , hasSetCustomPath = false
            , hasWorkOnedrive = false
            , acc_version;

        function SetAccVersionNum(num) {
            acc_version = num;
        }

        $("#skip_guide_text").on("click", function () {
            window.external.SkipGuide();
        });

        $("#custom_path_submit").on("click", function (e) {
            e.preventDefault();
            window.external.CheckManualPath($("#manualCheckPath").val());
            $("#fixModalContent").hide();
            $("#loadingModalContent").show();
        });

        $('#doesntWorkModal').on('hidden.bs.modal', function () {
            $("#pathError").hide();
            $("#pathSuccess").hide();
            $("#loadingModalContent").hide();
            $("#fixModalContent").show();
        });

        function ManualPathValidated(success) {
            setTimeout(function () {
                if (success) {
                    hasSetCustomPath = true;
                    canPopover = true;
                    canProceed = true;
                    cloudServiceInstalled = true;

                    $("#loading_container1").stop().fadeOut();
                    $("#couldNotFindService").stop().fadeOut();
                    $(".strike-out-if-installed").css("text-decoration", "line-through");
                    $("#looking_text").stop().fadeOut();
                    $("#service_found").stop().fadeIn();

                    if (activeStep == 1)
                        setNext(true);

                    if (canPopover)
                        showProceedTip = true;
                    //showHelpPopover();

                    $("#loadingModalContent").stop().fadeOut("fast", function () {
                        $("#pathSuccess").stop().fadeIn("fast");
                    });
                } else {
                    $("#loadingModalContent").stop().fadeOut("fast", function () {
                        $("#pathError").stop().fadeIn("fast");

                        activeTimeout = setTimeout(function () {
                            $("#pathError").stop().fadeOut("medium", function () {
                                $("#fixModalContent").stop().fadeIn("medium");
                            });
                        }, 8000)
                    });
                }
            }, 500);
        }

        $("#continue_button").on("click", function () {
            window.external.SetupSuccess(chosenCloudService.replace(" ", "").toLocaleLowerCase());
        });

        function DoneError() {
            canProceed = false;
            tipTimeout = null;
            tipShown = false;
            actionErrorTimer = null;
            hasBeenAtStep3 = false;
            canPopover = false;

            $("#cloud_setup").fadeOut("medium", function () {
                $("#choose_cloud_service").fadeIn("medium");
            });

            stepDivs[0].hide();
            stepDivs[1].hide();
            stepDivs[2].hide();

            chosenCloudService = "";
            chosenCloudServiceNum = 0;

            $(".card-selected").click();
            $("#finishError").modal("show");

            setTimeout(function () {
                $("#finishError").modal("hide");
            }, 10000);
        }

        $(".card.cloud_service_card").on("click", function () {
            let theThis = $(this), theName = $(this).attr("data-name");
            $(".card").removeClass("card-selected");
            $(this).addClass("card-selected");

            $("#pick_btn").prop("disabled", false).text("Proceed with " + theName);
            chosenCloudService = theName;
            chosenCloudServiceNum = $(this).attr("data-num");
            chosenCloudServiceImage = $(this).attr("data-image");
            cloudServiceInstalled = false;

            if (theName == "OneDrive" && hasWorkOnedrive) {
                $("#multipleOneDrive").show();
                window.external.SetODtype("OneDriveConsumer");
            } else {
                $("#multipleOneDrive").hide();
            }
        });

        $("#pick_btn").on("click", function () {
            if (chosenCloudServiceNum != 4) {
                $(".service-name").text(chosenCloudService);
                previousButton.stop().fadeIn();
                canProceed = false;
                tipTimeout = null;
                tipShown = false;
                actionErrorTimer = null;
                hasBeenAtStep3 = false;
                canPopover = false;
                nextButton.prop("disabled", true).removeClass("blink_me");

                $("#fixModalContent").show();
                $("#loadingModalContent").hide();
                setStep(1);

                $("body").css("overflow", "auto");

                if (stepDivs[chosenCloudServiceNum - 1] != null)
                    stepDivs[chosenCloudServiceNum - 1].show();
                else alert((chosenCloudServiceNum - 1) + " is null");

                $(".strike-out-if-installed").css("text-decoration", "none");
                $(".strike-out-if-installed-partial").css("text-decoration", "none");

                $("#looking_text").show();
                $("#service_found").hide();

                $("#manualCheckPath").val("");

                let stlgh = $(".shutdown_test_link_gh"), stla = $(".shutdown_test_link_alexa"), actionListLink = $("#acc_action_list");

                window.external.CloudServiceChosen(chosenCloudService.replace(" ", "").toLocaleLowerCase());
                //alert("Changing links!");
                switch (chosenCloudService.toLowerCase()) {
                    case "google drive":
                        actionListLink.attr("href", "https://assistantcomputercontrol.com/?cloud=gd#what-can-it-do");
                        stlgh.attr("href", "https://ifttt.com/applets/N5LtdnWq-acc-shut-down-computer-google-drive");
                        stla.attr("href", "https://ifttt.com/applets/zjKANwgB-acc-shut-down-computer-google-drive");
                        break;
                    case "dropbox":
                        actionListLink.attr("href", "https://assistantcomputercontrol.com/?cloud=db#what-can-it-do");
                        stlgh.attr("href", "https://ifttt.com/applets/W3b7fykE-acc-shut-down-computer-dropbox");
                        stla.attr("href", "https://ifttt.com/applets/pCPWA7je-acc-shut-down-computer-dropbox");
                        break;
                    case "onedrive":
                        actionListLink.attr("href", "https://assistantcomputercontrol.com/?cloud=od#what-can-it-do");
                        stlgh.attr("href", "https://ifttt.com/applets/SUZHkGLx-acc-shut-down-computer-onedrive");
                        stla.attr("href", "https://ifttt.com/applets/JgERNdXS-acc-shut-down-computer-onedrive");
                        break;
                }

                $("#install_step_name").text(chosenCloudService);
                $("#step-1-title").html("Install " + chosenCloudService);
                $("#chosenCloudServiceImage").attr("src", chosenCloudServiceImage);

                $("#choose_cloud_service").stop().fadeOut("medium", function () {
                    $("#cloud_setup").stop().fadeIn("medium");
                });

                if (hasSetCustomPath) {
                    hasSetCustomPath = false;
                    window.external.ClearCustomSetPath();
                }
            } else {
                window.external.ExpertChosen();
            }
        });

        function actionWentThrough(status, title, action) {
            if (activeStep != 3) {
                //Done action before step 3, way to go!
                if (!hasBeenAtStep3) {
                    if (status == "success") {
                        $("#fast_message").show();
                    } else {
                        $("#too_fast_message").show();
                    }
                }
                setStep(3);
            }

            if (status == "success") {
                $("#success_setup_action_went_through").show().find("span").text(action);
                $("#status_message").hide();

                $("#timeToTryText").stop().fadeOut("fast", function () {
                    $("#continue_button").attr("disabled", false);
                    $("#error_icon").stop().fadeOut("fast", function () {
                        $("#success_icon").stop().fadeIn();
                        $("#continue_button").stop().fadeIn();
                        $("#you_can_also_stay").stop().fadeIn();
                    });
                });
            } else if (status == "error") {
                $("#success_setup_action_went_through").hide();
                $("#status_message").show();

                $("#timeToTryText").stop().fadeOut("fast", function () {
                    $("#continue_button").attr("disabled", true);
                    $("#success_icon").stop().fadeOut("fast", function () {
                        $("#error_icon").stop().fadeIn();
                        $("#continue_button").stop().fadeIn();
                    });
                });

                //Fadeout after 20 seconds <---------------- NEEDS TESTING
                actionErrorTimer = setTimeout(function () {
                    resetActionTester();
                }, 20000);
            }
            $("#status_message").text(title);
        }

        function resetActionTester(force) {
            if (force == null)
                force = false;

            if (actionErrorTimer != null)
                clearTimeout(actionErrorTimer);

            $("#fast_message").hide();
            $("#too_fast_message").hide();

            if (!force) {
                $("#continue_button").stop().fadeOut("fast", function () {
                    $(this).attr("disabled", false);
                });
                $("#you_can_also_stay").stop().fadeOut("fast");
                $("#error_icon").stop().fadeOut("fast", function () {
                    $("#status_message").text("");
                    $("#success_setup_action_went_through").text("");
                    $("#timeToTryText").stop().fadeIn();
                });
                $("#success_icon").stop().fadeOut();
            } else {
                $("#success_icon").hide();
                $("#continue_button").hide().attr("disabled", false);
                $("#you_can_also_stay").hide();
                $("#error_icon").hide();
                $("#status_message").text("");
                $("#success_setup_action_went_through").text("");
                $("#timeToTryText").show();
            }

        }

        $('[data-toggle="popover"]').popover();
        CloudServiceInstalled(cloudServiceInstalled);

        nextButton.on("show.bs.popover", function (e) {
            if (!showProceedTip)
                e.preventDefault();
            else
                tipShown = true;
        });

        function canShowPopover() {
            canPopover = true;

            if (cloudServiceInstalled)
                showHelpPopover();
        }

        function showHelpPopover() {
            tipTimeout = setTimeout(function () {
                showProceedTip = true;
                nextButton.popover("toggle");
            }, 5000);
        }

        function CloudServiceInstalled(status, partial) {
            if (partial == null)
                partial = false;

            cloudServiceInstalled = status;
            if (status) {
                //Service installed
                $("#loading_container1").stop().fadeOut();
                $("#couldNotFindService").stop().fadeOut();
                $(".strike-out-if-installed").css("text-decoration", "line-through");
                $("#looking_text").stop().fadeOut();
                $("#service_found").stop().fadeIn();

                if (!partial)
                    $(".strike-out-if-installed-partial").css("text-decoration", "line-through");

                if (activeStep == 1 && !partial)
                    setNext(true);

                if (canPopover && !partial)
                    showProceedTip = true;
                //showHelpPopover();
            } else {
                //Service not installed
                $(".strike-out-if-installed").css("text-decoration", "none");
                $(".strike-out-if-installed-partial").css("text-decoration", "none");

                $("#loading_container1").stop().fadeIn();
                $("#couldNotFindService").stop().fadeIn();
                //$("#step-1-title").html("Install " + chosenCloudService);
                $("#looking_text").stop().fadeIn("fast");
                $("#service_found").stop().fadeOut();

                $("#step-2-btn").attr("disabled", true);
                $("#step-3-btn").attr("disabled", true);
                if (activeStep != 1) {
                    setNext(false);
                    setStep(1);
                }
            }
        }

        function setStep(step) {
            activeStep = step;
            if (step == 1) {
                //previousButton.stop().fadeOut();
                nextButton.stop().fadeIn();
                CloudServiceInstalled(cloudServiceInstalled);
            } else if (step == 2) {
                window.external.SetPath(chosenCloudService.replace(" ", "").toLocaleLowerCase());

                previousButton.stop().fadeIn();
                nextButton.stop().fadeIn();
                setNext(true);

                resetActionTester(true);
            } else if (step == 3) {
                hasBeenAtStep3 = true;

                previousButton.stop().fadeIn();
                nextButton.stop().fadeOut();
            }

            if (step != 1) {
                $("#step-2-btn").attr("disabled", false);
                $("#step-3-btn").attr("disabled", false);
            }

            $("#step-" + step + "-btn").attr("disabled", false).click();
        }

        $("#nextButton, #previousButton").hover(function () {
            if (canProceed) {
                $(this).removeClass("blink_me");
            }
            $(this).css("color", "#fff");
            $(this).css("background-color", "#428bca");
            $(this).css("border-color", "#357ebd");
        }, function () {
            $(this).css("color", "#212121");
            $(this).css("background-color", "transparent");
            $(this).css("border-color", "transparent");

            if (canProceed && $(this) == nextButton) {
                $(this).addClass("blink_me");
            }
        });

        previousButton.on("click", function () {
            if (activeStep == 2) {
                $("#step-1-btn").attr("disabled", false).click();
                activeStep = 1;
            } else if (activeStep == 3) {
                $("#step-2-btn").attr("disabled", false).click();
                activeStep = 2;
            } else if (activeStep == 1) {
                //Back to selection
                $("body").css("overflow", "hidden");
                $("#cloud_setup").stop().fadeOut("medium", function () {
                    stepDivs[0].hide();
                    stepDivs[1].hide();
                    stepDivs[2].hide();

                    chosenCloudService = "";
                    chosenCloudServiceNum = 0;

                    $(".card-selected").click();

                    $("#choose_cloud_service").stop().fadeIn("medium");
                });
            }
            setStep(activeStep);
        });

        function handlePopover() {
            if (tipTimeout != null)
                clearTimeout(tipTimeout);
            showProceedTip = false;
            if (tipShown)
                nextButton.popover("hide");
        }

        nextButton.on("click", function () {
            handlePopover();

            if (activeStep == 1 && cloudServiceInstalled) {
                $("#step-2-btn").attr("disabled", false).click();
                activeStep = 2;
            } else if (activeStep == 2) {
                $("#step-3-btn").attr("disabled", false).click();
                activeStep = 3;
            }
            setStep(activeStep);
        });

        function setNext(status) {
            canProceed = status;
            if (status) {
                nextButton.prop("disabled", false).addClass("blink_me");
            } else {
                nextButton.prop("disabled", true).removeClass("blink_me");
            }
        }

        var navListItems = $('div.setup-panel div a'),
            allWells = $('.setup-content');

        navListItems.click(function (e) {
            e.preventDefault();
            var $target = $($(this).attr('href')),
                $item = $(this),
                navNum = $item.attr("data-step-num");

            activeStep = navNum;
            if (activeStep == 3)
                hasBeenAtStep3 = true;

            handlePopover();
            if (activeStep == 1) {
                CloudServiceInstalled(cloudServiceInstalled);
                //previousButton.stop().fadeOut();
                nextButton.stop().fadeIn();
            } else if (activeStep == 3) {
                previousButton.stop().fadeIn();
                nextButton.stop().fadeOut();
            }

            if (!$item.hasClass('disabled')) {
                navListItems.removeClass('btn-primary').addClass('btn-default');
                $item.addClass('btn-primary');
                allWells.hide();
                $target.show();
                $target.find('input:eq(0)').focus();
            }
        });

        $('div.setup-panel div a.btn-primary').trigger('click');

        function HasWorkOneDrive(doesHas) {
            hasWorkOnedrive = doesHas;
        }

        $(".onedrive_type").on("click", function () {
            $(".onedrive_type").addClass("btn-default").removeClass("btn-primary chosen_onedrive_type");
            $(this).removeClass("btn-default").addClass("btn-primary chosen_onedrive_type");

            window.external.SetODtype($(this).attr("data-onedrive-type"));
        });
    </script>

</body>
</html>